---
title: DarkSide Ransomware Analysis
classes: wide
header:
  teaser: https://user-images.githubusercontent.com/84356407/195297454-6b7ee3b6-739d-49ed-a140-497edd91b503.jpeg
ribbon: MidnightBlue
categories:
  - MalwareAnalysis
toc: true
---

# Introduction  
Ransomware, is a type of malware that prevents users from accessing their system or files and demands that a ransom be paid to regain access.
Users are shown instructions on how to pay a ransom to obtain a decryption key to decrypt their files and get them back.

# Whatâ€™s DarkSide Ransomware
-	The threat actors behind DarkSide ransomware are of Russian origin and are likely former affiliates of the REvil RaaS [ransomware-as-a-service] group.

-	DarkSide ransomware appeared in August 2020


-	DarkSide ransomware operates as a service(RaaS)

# Full Analysis
Here I did all aspects of Analysis so, I passed by Static, Dynamic, Advanced Static, and Advanced Dynamic analysis.<br> Supporting by Pictures from Analysis To help for reading easily. So, Let's Start. 

# Static Analysis 

MD5: 0202E80ABE75635256443CB5FD7C0283<br>
SHA1 : A78851A9490DA007771DA340EC8F8C96745D8913<br>
SHA256 : 9BD51F68587E0E49E8C0F8225BC8C3FEAC453EBD6B34B0ABA91C493CE75F4E80<br>
### Virustotal
<img src="https://user-images.githubusercontent.com/84356407/195300493-21036bee-bf8f-49a8-99a3-64be2db7f0e7.png" width="600">

### Unpacked
This sample is unpacked. It was checked by DIE
<img src="https://user-images.githubusercontent.com/84356407/195300518-9b0727a2-75d3-4f16-8cb1-46114461e344.png" width="500">

### Strings
While Looking for Strings, I didn't Found many strings in this sample<br>
<img src="https://user-images.githubusercontent.com/84356407/195301825-91b279d6-8c1d-48c1-8446-85e69341342e.png" width="500">

# Dynamic Analysis 

* When you click on the sample to run it, it imediatly ctreates a process by it's name as shown:<br>
<img src="https://user-images.githubusercontent.com/84356407/195307539-eaa243b3-7da1-4f4e-b24b-d01cef1dfa21.png" width="400">
* Then It encrypes files sytem as showm:-<br>
<img src="https://user-images.githubusercontent.com/84356407/195307560-edd57f5d-68be-4f46-9cb9-3b572bb6999a.png" width="400">
* The encrypted file extention is .f1f25696 as shown:-<br>
<img src="https://user-images.githubusercontent.com/84356407/195307576-90f9bb8b-836d-4163-b5b8-5ddfb7302489.png" width="400">
* The Wallpaper of the disktop  is changed as shown:-<br>
<img src="https://user-images.githubusercontent.com/84356407/195307591-62065fec-9f9b-4c88-aee5-fbf4dc0465b0.png" width="400">

# Advanced Static Analysis 

I faced many struggles while I was analyzing the assembly code by IDA Like:
- there are many loops  in functions
- The third function in the main function is so long And I didn't catch anything.
- There are no APIs That can help me in the analysis.
- There are many calls like "call dword-4208D0" so, it calls something from the data section and that is maybe resolving API functions and put addresses for these functions inside these addresses like "dword-4208D0" 
- Make an import address table for itself for making the analysis difficult for analysts.

<p float="left">
  <img src="https://user-images.githubusercontent.com/84356407/195363925-8dd57703-7fec-4626-9726-e7347d24923b.png" width="200" />
  <img src="https://user-images.githubusercontent.com/84356407/195363935-aeef7184-c83f-449e-a0e1-06ea4996a5aa.png" width="200" /> 
  <img src="https://user-images.githubusercontent.com/84356407/195363948-7f5729e8-2b96-43c2-b64c-725c5e83a449.png" width="200" />
  <img src="https://user-images.githubusercontent.com/84356407/195363972-095251dd-0d53-48db-839f-386ef63aadce.png" width="300" />
</p>

# Advanced Dynamic Analysis 
<img src="https://user-images.githubusercontent.com/84356407/178153830-083069a9-06d3-4aa7-87af-5c638712db61.png" width="400">
<br /><br />By examining this function 'KeyLogging_Fun' we can find :-

First : it creates a file called 'practicalmalwareanalysis.log' by calling 'CreateFileA' function to recode everything that you write on the keyboard then  as shown in the following picture:-

<img src="https://user-images.githubusercontent.com/84356407/178156194-7c894054-9572-416c-a875-18a7f2e2d63a.png" width="400">
<br /><br />Inside this file 'practicalmalwareanalysis.log' it recodes the window name that you open by calling this fun 'GetForegroundWindow' as shown in the following picture:-

<img src="https://user-images.githubusercontent.com/84356407/178156200-f85c2643-7757-425e-81a0-bf0c13c43d09.png" width="400">
<br /><br />It recodes the window name as the folloing pattern " [Window:  New Tab - window name]" as shown in the following picture:-<br /><br />
<img src="https://user-images.githubusercontent.com/84356407/178156205-ce6acb23-acbd-4761-ab3c-ad4c697ef822.png" width="400"><br />
<img src="https://user-images.githubusercontent.com/84356407/178156450-1c64ee3c-80b7-4788-b7a9-debee841d02e.png" width="500">

<br />Then it recodes eveything that you write on the keyboard but it first make a comparission in some case by its switch cases to check if you cleck on 'BackSpace','Crtl' or numbers etc. Then it recodes these Keystrokes as shown in the following picture:-<br /><br />

<img src="https://user-images.githubusercontent.com/84356407/178156226-06d41da3-a783-48ff-a634-de052cf8b74d.png" width="500">
<br /><br />Then it close the Handle for the file 'practicalmalwareanalysis.log' by calling 'CloseHandle' funcion as shown in the following picture:-<br />
<img src="https://user-images.githubusercontent.com/84356407/178156229-ee146033-8f11-45a0-b2d4-6b994c7d858e.png" width="500"><br /><br />

# IOCs <br />
####--------
### Hashes

sha256 : 9B683D2FDA7CA7ADCC043E4412271009A0E115CA55F9A718C385A3F46B57AE6B

### Functions

WriteFile

GetForegroundWindow

SetWindowsHookExA

### Strings

practicalmalwareanalysis.log

[SHIFT]

[TAB]

[BACKSPACE]

[CAPS LOCK]

# Sumerization
This malware called 'Keylogger', creates a file called 'practicalmalwareanalysis.log' then it records everything that you write on the keyboard
and this is a picture that shows the functionality after running this malware




<img src="https://user-images.githubusercontent.com/84356407/178157096-6f599656-2aa4-4c40-a687-169987f8eeb9.png" width="500">
