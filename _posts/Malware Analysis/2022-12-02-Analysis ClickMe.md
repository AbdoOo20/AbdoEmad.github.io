---
title: Analysis ClickMe .NET
classes: wide
header:
  teaser: https://user-images.githubusercontent.com/84356407/205319077-c9ca1988-9596-4bbf-a21a-27ab1f67aa36.png
ribbon: MidnightBlue
categories:
  - MalwareAnalysis
toc: true
---

# Introduction
This challenge is called ClickMe. it is written in .NET

# How it works
- First, if you run the exe file (ClickMe) there is a message box will appear as the following:
<img src="https://user-images.githubusercontent.com/84356407/205482766-fcd57e56-5c76-457b-89e9-060218894060.png" width="300">
- After clicking on "OK" there are three monsters you must beat them depending on their "hp" you must click "number of clicking" as the following:
<p float="left">
  <img src="https://user-images.githubusercontent.com/84356407/205482771-e52f2904-c123-46d4-9ee2-9bbbb73477bd.png" width="200">
  <img src="https://user-images.githubusercontent.com/84356407/205482772-efe3e468-6ca5-40e7-8cf6-488355ee1114.png" width="200">
  <img src="https://user-images.githubusercontent.com/84356407/205482782-95dc8042-22f5-462f-90a9-104eadaab222.png" width="200">
  <img src="https://user-images.githubusercontent.com/84356407/205482784-9fcf5047-af67-4fd7-b1a8-bcd7263a9b23.png" width="200">
</p>
- But the third monster requires to click 100.000.000 times to beat him as the following:
<img src="https://user-images.githubusercontent.com/84356407/205482787-cb10d0df-f82c-43df-b8fa-663cfbc11b35.png" width="200">
# Detailed Analysis
- So the first step is to know which language is that app is written to deal with so I used Detect it easy "DIE" to know as the following: <br>
<img src="https://user-images.githubusercontent.com/84356407/205483408-20f27d41-9ff9-42d1-822e-4c506c1b36ed.png" width="400">
- After knowing that we are gonna use "dnSpy" to analysis this .NET Code <br>
- After loading that app on dnSpy we are gonna go to the entry point so by clicking right-click on the app and go the entry point as the following: 
<img src="https://user-images.githubusercontent.com/84356407/205483581-9299adb0-d429-4474-a751-9dc58c10218a.png" width="500">
- It runs the form as the following:<br>
<img src="https://user-images.githubusercontent.com/84356407/205483629-18b870ea-e393-4e0d-a40b-898ffed09578.png" width="500">
-  We have three monsters and their names store in "monster_a[]"as the following:
<img src="https://user-images.githubusercontent.com/84356407/205483692-4307ef7e-b689-44a1-830d-d7397eed18fd.png" width="500">
<img src="https://user-images.githubusercontent.com/84356407/205483944-097f8677-2c6b-44b8-b45b-54efd67334ca.png" width="500"><br>

# Beating the First Monster <br>
- There is a variable called "cur_hp_num" it decreases by one each time you click on the "Hit" to beat him. I put a break point there to watch its value as the following 
<img src="https://user-images.githubusercontent.com/84356407/205484322-06ee2635-76f9-42b4-8f1a-16cfcf0c3cd7.png" width="500">
- I added the variable on the watch section to watch its value <br>
- for beating him, I put the value for "cur_hp_num" by zero "0" and starting debugging as the following :<br>
<img src="https://user-images.githubusercontent.com/84356407/205484275-cca30b83-cd2d-4c91-9af5-40776a30f603.png" width="500">
- The final message is :<br>
<img src="https://user-images.githubusercontent.com/84356407/205484539-933c7f79-4bbe-458f-9418-09e59556cd94.png" width="500">

# Beating the Second Monster <br>
As I did in the first monster as I did in the second one as the following:-
<p float="left">
  <img src="https://user-images.githubusercontent.com/84356407/205484710-ca5e45f7-ac7a-4a77-bc89-82472ac2738f.png" width="400">
  <img src="https://user-images.githubusercontent.com/84356407/205484632-be7ff584-5216-4ec9-b18e-6c5429bfa3a0.png" width="400">
  <img src="https://user-images.githubusercontent.com/84356407/205484654-f4c5a12b-76ec-43d1-98f1-05b255c68b4b.png" width="400">
</p>

# Beating the Third Monster<br>
- I did as I did in the previous two monsters but it appears a message says "It's not fair! Cheating is wrong"<br>
- I searched for this message and I found it inside a condition that checks another variable's value that must not equal one "1"<br>
- Then I searched for that variable called "check_point", and I found it increases by one inside a condition check "the monster must be the third one and the cur_hp_num must be 689"<br>

- So I change this variable "check_point" and make it "1" "true" to not enter in the condition of the message "It's not fair! Cheating is wrong"<br>
- Then I changed the value for the cur_hp_num by zero "0" <br>
- As the following<br>

<img src="https://user-images.githubusercontent.com/84356407/205484974-5b491c8b-243f-476f-87b4-7646aed7c945.png" width="500">
<img src="https://user-images.githubusercontent.com/84356407/205484970-a6235a78-a1a7-4d9c-91ea-c5d5dda6f7e0.png" width="500"><br>
<img src="https://user-images.githubusercontent.com/84356407/205484973-a38eb76a-91ec-4811-99f7-e915c5ab608c.png" width="500">
 
Thansk ☻♥
 


